<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lara - Inicio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.0/lucide.min.js"></script>
    <link rel="manifest" href="/Lara/manifest.json">
    <style>
        :root { --primary: #3b82f6; --bg: #f8fafc; --card: #ffffff; }
        body { background-color: var(--bg); font-family: 'Inter', sans-serif; }
        .menu-card { transition: transform 0.2s; }
        .menu-card:active { transform: scale(0.95); }
        .welcome-screen { background: #0f172a; color: white; }
    </style>
</head>
<body class="pb-20">

    <!-- Pantalla de Bienvenida -->
    <div id="welcome" class="fixed inset-0 z-50 welcome-screen flex flex-col items-center justify-center p-6 text-center">
        <div class="w-32 h-32 bg-white p-4 rounded-3xl mb-6 shadow-2xl">
            <img src="aa.jpg" alt="Logo" class="w-full h-full object-contain">
        </div>
        <h1 class="text-3xl font-black mb-1 uppercase text-blue-400">MULTI SERVICIOS LARA</h1>
        <p class="text-slate-400 text-lg mb-1">Servicio de Transporte Privado</p>
        <p class="text-blue-300 font-semibold mb-10 italic">"Moviendo Vidas"</p>
        <button onclick="document.getElementById('welcome').style.display='none'" class="bg-blue-600 text-white font-bold py-4 px-12 rounded-2xl w-full max-w-xs shadow-lg active:scale-95 transition-transform">ENTRAR</button>
    </div>

    <header class="p-6 bg-white border-b border-slate-200 sticky top-0 z-30 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-black text-slate-800">LARA</h1>
            <p class="text-xs text-slate-500 font-bold uppercase tracking-widest">Panel de Control</p>
        </div>
        <img src="aa.jpg" class="h-10 w-10 rounded-xl object-cover border-2 border-blue-100">
    </header>

    <main class="p-6 space-y-6 max-w-md mx-auto">
        <!-- Resumen Rápido -->
        <div class="bg-blue-600 rounded-3xl p-6 text-white shadow-xl shadow-blue-200">
            <p class="text-blue-100 text-xs font-bold uppercase mb-1">Ganancia Neta (Mes)</p>
            <h2 id="resumen-neto" class="text-4xl font-black">Q.0</h2>
            <div class="grid grid-cols-2 gap-4 mt-6">
                <div class="bg-blue-500/30 p-3 rounded-2xl">
                    <p class="text-[10px] text-blue-100 uppercase font-bold">Ingresos</p>
                    <p id="resumen-ingresos" class="text-lg font-bold">Q.0</p>
                </div>
                <div class="bg-blue-500/30 p-3 rounded-2xl">
                    <p class="text-[10px] text-blue-100 uppercase font-bold">Gastos</p>
                    <p id="resumen-gastos" class="text-lg font-bold">Q.0</p>
                </div>
            </div>
        </div>

        <!-- Menú Principal -->
        <div class="grid grid-cols-1 gap-4">
            <a href="/Lara/registros.html" class="menu-card bg-white p-5 rounded-3xl flex items-center gap-4 shadow-sm border border-slate-100">
                <div class="bg-emerald-100 p-3 rounded-2xl text-emerald-600"><i data-lucide="bar-chart-3"></i></div>
                <div class="flex-1">
                    <h3 class="font-bold text-slate-800">Registros</h3>
                    <p class="text-xs text-slate-500">Finanzas y categorías</p>
                </div>
                <i data-lucide="chevron-right" class="text-slate-300"></i>
            </a>

            <a href="/Lara/viajes.html" class="menu-card bg-white p-5 rounded-3xl flex items-center gap-4 shadow-sm border border-slate-100">
                <div class="bg-blue-100 p-3 rounded-2xl text-blue-600"><i data-lucide="truck"></i></div>
                <div class="flex-1">
                    <h3 class="font-bold text-slate-800">Viajes</h3>
                    <p class="text-xs text-slate-500">Rutas y clientes</p>
                </div>
                <i data-lucide="chevron-right" class="text-slate-300"></i>
            </a>

            <a href="/Lara/diezmos.html" class="menu-card bg-white p-5 rounded-3xl flex items-center gap-4 shadow-sm border border-slate-100">
                <div class="bg-purple-100 p-3 rounded-2xl text-purple-600"><i data-lucide="heart"></i></div>
                <div class="flex-1">
                    <h3 class="font-bold text-slate-800">Diezmos</h3>
                    <p class="text-xs text-slate-500">Cálculo quincenal</p>
                </div>
                <i data-lucide="chevron-right" class="text-slate-300"></i>
            </a>

            <a href="/Lara/resumen.html" class="menu-card bg-white p-5 rounded-3xl flex items-center gap-4 shadow-sm border border-slate-100">
                <div class="bg-slate-100 p-3 rounded-2xl text-slate-600"><i data-lucide="pie-chart"></i></div>
                <div class="flex-1">
                    <h3 class="font-bold text-slate-800">Resumen</h3>
                    <p class="text-xs text-slate-500">Historial y reportes</p>
                </div>
                <i data-lucide="chevron-right" class="text-slate-300"></i>
            </a>
        </div>
    </main>

    <script>
        const formatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'GTQ', minimumFractionDigits: 0, maximumFractionDigits: 0 });
        function formatQ(n) { return formatter.format(n).replace('GTQ', 'Q'); }

        function updateSummary() {
            const registros = JSON.parse(localStorage.getItem('registros') || '[]');
            const hoy = new Date();
            const start = new Date(hoy.getFullYear(), hoy.getMonth(), 1);
            const end = new Date(hoy.getFullYear(), hoy.getMonth() + 1, 0, 23, 59, 59);

            let ing = 0, gas = 0;
            registros.forEach(r => {
                const d = new Date(r.fecha + 'T00:00:00');
                if(d >= start && d <= end) {
                    if(r.tipo === 'Ingreso') ing += Math.round(Number(r.monto));
                    else gas += Math.round(Number(r.monto));
                }
            });

            document.getElementById('resumen-neto').textContent = formatQ(ing - gas);
            document.getElementById('resumen-ingresos').textContent = formatQ(ing);
            document.getElementById('resumen-gastos').textContent = formatQ(gas);
        }

        window.onload = () => {
            lucide.createIcons();
            updateSummary();
            if('serviceWorker' in navigator) navigator.serviceWorker.register('/Lara/sw.js');
        };
    </script>
</body>
</html>
